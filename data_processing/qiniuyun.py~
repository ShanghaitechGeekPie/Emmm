from qiniu import Auth, put_file, etag, urlsafe_base64_encode
import qiniu.config
import os
import os.path
access_key = '98X99xewheAEvlTQ1BbwqebxLwe26RuLfkD9KRNx'
secret_key = 'eX8Svx4EX86LrzmkEVJPBj4UdKUW9Pg27xaLzweO'
q = Auth(access_key, secret_key)

bucket_name = 'ai-hackathon'




rootdir = './office'
for parent,dirnames,filenames in os.walk(rootdir):

	for filename in filenames:   
		full_name = os.path.join(parent,filename)
		localfile = full_name
		key = full_name[1:]
		token = q.upload_token(bucket_name, key, 3600)
		ret, info = put_file(token, key, localfile)
		print(info)
		assert ret['key'] == key
		assert ret['hash'] == etag(localfile)